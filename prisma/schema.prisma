generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("PRISMA_POSTGRES_DATABASE_URL")
}

model PendingUsers {
  id             String   @id @default(cuid())
  name           String
  address        String
  email          String   @unique
  phoneNumber    String
  hashedPassword String
  hashedOTP      String
  logo           Bytes?
  createdAt      DateTime @default(now())
  expiresAt      DateTime @default(dbgenerated("(now()+ interval '2 minutes')"))
}

model VerifiedUsers {
  id             String     @id @default(cuid())
  name           String
  address        String
  email          String     @unique
  phoneNumber    String
  hashedPassword String
  logo           Bytes?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  invoices       Invoices[]
}

model Invoices {
  id                     String         @id @default(cuid())
  recipientName          String
  recipientAddress       String
  recipientEmail         String?
  recipientContactPerson Json?
  recipientPhoneNumber   String?
  purchaseOrder          String?
  invoiceNumber          String
  invoiceDate            String
  dueDate                String
  customInvoiceFields    Json?
  notes                  String?
  terms                  String?
  issuerBrandLogo        Bytes?
  discount               String?
  tax                    String?
  shipping               String?
  grandTotal             Decimal        @db.Decimal(10, 2)
  aggregateSubTotals     Decimal        @db.Decimal(10, 2)
  calculatedDiscount     Decimal        @db.Decimal(10, 2)
  calculatedTax          Decimal        @db.Decimal(10, 2)
  utilisePercentDiscount Boolean
  utilisePercentTax      Boolean
  utiliseTaxableShipping Boolean
  currency               String
  ownerID                String
  paymentMethods         Json
  invoiceItems           InvoiceItems[]
  issuerRelation         Issuers?
  ownerRelation          VerifiedUsers  @relation(fields: [ownerID], references: [id], onDelete: Cascade)
}

model Issuers {
  id               String   @id @default(cuid())
  name             String
  role             String
  signature        Bytes
  relatedInvoiceID String   @unique
  invoiceRelation  Invoices @relation(fields: [relatedInvoiceID], references: [id], onDelete: Cascade)
}

model InvoiceItems {
  id               String   @id @default(cuid())
  item             String
  quantity         String
  currency         String
  unitPrice        String
  subTotal         String
  description      String?
  relatedInvoiceID String
  invoiceRelation  Invoices @relation(fields: [relatedInvoiceID], references: [id], onDelete: Cascade)
}
